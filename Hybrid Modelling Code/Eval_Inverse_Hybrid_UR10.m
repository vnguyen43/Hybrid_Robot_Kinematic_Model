clear all
close all
clc

r2s = csvread('Robot2Sensor_UR10.csv');%Sensor-Robot Transformation: Robot = r2s*TRIO
data = csvread('Data_UR10_1000.csv'); %Data of interest
data( ~any(data,2), : ) = []; %Remove 0's

q_deg = data(:,1:6);q = deg2rad(q_deg);
q1_rad = q(:,1); q2_rad = q(:,2); q3_rad = q(:,3); q4_rad = q(:,4); q5_rad = q(:,5); q6_rad = q(:,6);
q1_deg = q_deg(:,1); q2_deg = q_deg(:,2); q3_deg = q_deg(:,3); q4_deg = q_deg(:,4); q5_deg = q_deg(:,5); q6_deg = q_deg(:,6);
px = data(:,7); py = data(:,8); pz = data(:,9); rx = deg2rad(data(:,10)); ry = deg2rad(data(:,11)); rz = deg2rad(data(:,12));

for k = 1:1:length(q1_deg)

trio = eye(4);
trio(1:3,4) = [px(k);py(k);pz(k)];
trio(1:3,1:3) = (SpinCalc('EA321toDCM',rad2deg([rz(k),ry(k),rx(k)]),0))';
H06 = r2s*trio;

H60 = H06^-1;

H_input(k,:) = [H06(1,1),H06(1,2),H06(1,3),H06(1,4),H06(2,1),H06(2,2),H06(2,3),H06(2,4),H06(3,1),H06(3,2),H06(3,3),H06(3,4)];

%Dh parameters
d0 = 0;     d1 = 0.1273*1000;   d2 = 0;             d3 = 0;             d4 = 0.163941*1000;     d5 = 0.1157*1000;   d6 = 0.0922*1000;% d (unit: mm)
a0 = 0;     a1 = 0;             a2 = -0.612*1000;   a3 = -0.5723*1000;  a4 = 0;                 a5 = 0;             a6 = 0;% a (unit: mm)
p0 = 0;     p1 = +pi/2;         p2 = 0;             p3 = 0;             p4 = +pi/2;             p5 = -pi/2;         p6 = 0; %alpha

end

numFolds = 5;
H_input_cv = H_input;

%Uncalibrated
q1_basis = @(H) 57.295779513082320876798154814105.*atan2(1.0.*H(:,8) - 92.2.*H(:,7), H(:,4) - 92.2.*H(:,3)) + 57.295779513082320876798154814105.*acos(163.94100000000000250111042987555./((92.2.*H(:,3) - 1.0.*H(:,4)).^2 + (92.2.*H(:,7) - 1.0.*H(:,8)).^2).^(1./2)) + 90.0;
q5_basis = @(H) 57.295779513082320876798154814105.*acos(0.010845986984815618221258134490239.*H(:,4).*sin(H(:,13)) - 0.010845986984815618221258134490239.*H(:,8).*cos(H(:,13)) - 1.778101952277657293938290996481);
q6_basis = @(H) 57.295779513082320876798154814105.*angle((((cos(H(:,13)).*(H(:,1).*H(:,11) - 1.0.*H(:,3).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,5).*H(:,11) - 1.0.*H(:,7).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9))).*1.0i)./sin(H(:,14)) + ((cos(H(:,13)).*(H(:,2).*H(:,11) - 1.0.*H(:,3).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,6).*H(:,11) - 1.0.*H(:,7).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)))./sin(H(:,14)));
q3_basis = @(H) 57.295779513082320876798154814105.*acos(0.0000014275615307570985501199422658377.*((1.8726705418768793308623397655435e-97.*H(:,9).*(3.7482011137367831050098519004666e+49.*cos(H(:,14)).*sin(H(:,15)) + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14)) - 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*sin(H(:,15)) - 6.1783425014012324133276002850955e+98.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*H(:,10).*(6.1212769532348864768164853591134e+65.*sin(H(:,14)).*sin(H(:,15)) - 3.7482011137367831050098519004666e+49.*cos(H(:,14)).*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - 1.0.*H(:,12) + (1.7727318946148612699057147063994e-126.*H(:,11).*(6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + 127.3).^2 + 0.0000014275615307570985501199422658377.*((1.8726705418768793308623397655435e-97.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.1212769532348864768164853591134e+65.*sin(H(:,14)).*sin(H(:,15)) - 3.7482011137367831050098519004666e+49.*cos(H(:,14)).*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.7482011137367831050098519004666e+49.*cos(H(:,14)).*sin(H(:,15)) + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14)) - 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*sin(H(:,15)) - 6.1783425014012324133276002850955e+98.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.7727318946148612699057147063994e-126.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + 0.0000014275615307570985501199422658377.*((1.8726705418768793308623397655435e-97.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.7482011137367831050098519004666e+49.*cos(H(:,14)).*sin(H(:,15)) + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14)) - 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*sin(H(:,15)) - 6.1783425014012324133276002850955e+98.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.1212769532348864768164853591134e+65.*sin(H(:,14)).*sin(H(:,15)) - 3.7482011137367831050098519004666e+49.*cos(H(:,14)).*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.7727318946148612699057147063994e-126.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.0.*H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 - 1.0022499654530109920156662465904);
q2_basis = @(H)- 57.295779513082320876798154814105.*asin((572.3.*sin(H(:,16)))./(((1.8726705418768793308623397655435e-97.*H(:,9).*(3.7482011137367831050098519004666e+49.*cos(H(:,14)).*sin(H(:,15)) + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14)) - 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*sin(H(:,15)) - 6.1783425014012324133276002850955e+98.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*H(:,10).*(6.1212769532348864768164853591134e+65.*sin(H(:,14)).*sin(H(:,15)) - 3.7482011137367831050098519004666e+49.*cos(H(:,14)).*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - 1.0.*H(:,12) + (1.7727318946148612699057147063994e-126.*H(:,11).*(6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + 127.3).^2 + ((1.8726705418768793308623397655435e-97.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.1212769532348864768164853591134e+65.*sin(H(:,14)).*sin(H(:,15)) - 3.7482011137367831050098519004666e+49.*cos(H(:,14)).*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.7482011137367831050098519004666e+49.*cos(H(:,14)).*sin(H(:,15)) + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14)) - 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*sin(H(:,15)) - 6.1783425014012324133276002850955e+98.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.7727318946148612699057147063994e-126.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + ((1.8726705418768793308623397655435e-97.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.7482011137367831050098519004666e+49.*cos(H(:,14)).*sin(H(:,15)) + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14)) - 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*sin(H(:,15)) - 6.1783425014012324133276002850955e+98.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.1212769532348864768164853591134e+65.*sin(H(:,14)).*sin(H(:,15)) - 3.7482011137367831050098519004666e+49.*cos(H(:,14)).*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,14)).^2.*cos(H(:,15)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.7727318946148612699057147063994e-126.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.0.*H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2).^(1./2)) + 57.295779513082320876798154814105.*atan2((1.8726705418768793308623397655435e-97.*H(:,9).*(- 6.1783425014012324133276002850955e+98.*sin(H(:,15)).*cos(H(:,14)).^2 + 3.7482011137367831050098519004666e+49.*sin(H(:,15)).*cos(H(:,14)) - 6.1783425014012324133276002850955e+98.*sin(H(:,15)).*sin(H(:,14)).^2 + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*H(:,10).*(6.1783425014012324133276002850955e+98.*cos(H(:,15)).*cos(H(:,14)).^2 - 3.7482011137367831050098519004666e+49.*cos(H(:,15)).*cos(H(:,14)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2 + 6.1212769532348864768164853591134e+65.*sin(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - 1.0.*H(:,12) + (1.7727318946148612699057147063994e-126.*H(:,11).*(5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + 127.3, (1.8726705418768793308623397655435e-97.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(- 6.1783425014012324133276002850955e+98.*sin(H(:,15)).*cos(H(:,14)).^2 + 3.7482011137367831050098519004666e+49.*sin(H(:,15)).*cos(H(:,14)) - 6.1783425014012324133276002850955e+98.*sin(H(:,15)).*sin(H(:,14)).^2 + 6.1212769532348864768164853591134e+65.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.8726705418768793308623397655435e-97.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.1783425014012324133276002850955e+98.*cos(H(:,15)).*cos(H(:,14)).^2 - 3.7482011137367831050098519004666e+49.*cos(H(:,15)).*cos(H(:,14)) + 6.1783425014012324133276002850955e+98.*cos(H(:,15)).*sin(H(:,14)).^2 + 6.1212769532348864768164853591134e+65.*sin(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.7727318946148612699057147063994e-126.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.2010120808499989765693126337891e+127.*cos(H(:,14)).^2 + 6.4663670032761926322505539932867e+94.*cos(H(:,14)) + 5.2010120808499989765693126337891e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.0.*H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2));
q4_basis = @(H) 57.295779513082320876798154814105.*atan2((1.0.*(cos(H(:,17)).*sin(H(:,16)) + cos(H(:,16)).*sin(H(:,17))).*((1.0.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (0.00000000000000006123233995736766035868820147292.*(cos(H(:,17)).*cos(H(:,16)) - 1.0.*sin(H(:,17)).*sin(H(:,16))).*((1.0.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))).*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))).*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (1.0.*(cos(H(:,17)).*cos(H(:,16)) - 1.0.*sin(H(:,17)).*sin(H(:,16))).*((1.0.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*H(:,9).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*H(:,10).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2), - (1.0.*(cos(H(:,17)).*cos(H(:,16)) - 1.0.*sin(H(:,17)).*sin(H(:,16))).*((1.0.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (0.00000000000000006123233995736766035868820147292.*(cos(H(:,17)).*sin(H(:,16)) + cos(H(:,16)).*sin(H(:,17))).*((1.0.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))).*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))).*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (1.0.*(cos(H(:,17)).*sin(H(:,16)) + cos(H(:,16)).*sin(H(:,17))).*((1.0.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*H(:,9).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*H(:,10).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2));
 
%Calibrated
% q1_basis =@(H)57.295779513082320876798154814105.*atan2(1.0.*H(:,8) - 92.20018177000000036969140637666.*H(:,7), H(:,4) - 92.20018177000000036969140637666.*H(:,3)) + 57.295779513082320876798154814105.*acos(166.3481800000000134787114802748./((92.20018177000000036969140637666.*H(:,3) - 1.0.*H(:,4)).^2 + (92.20018177000000036969140637666.*H(:,7) - 1.0.*H(:,8)).^2).^(1./2)) + 90.0;
% q5_basis =@(H)57.295779513082320876798154814105.*acos(0.010845965602264994276381020663857.*H(:,4).*sin(H(:,13)) - 0.010845965602264994276381020663857.*H(:,8).*cos(H(:,13)) - 1.8042066382793858217760408518898);
% q6_basis =@(H)57.295779513082320876798154814105.*angle((((cos(H(:,13)).*(H(:,1).*H(:,11) - 1.0.*H(:,3).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,5).*H(:,11) - 1.0.*H(:,7).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9))).*1.0i)./sin(H(:,14)) + ((cos(H(:,13)).*(H(:,2).*H(:,11) - 1.0.*H(:,3).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,6).*H(:,11) - 1.0.*H(:,7).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)))./sin(H(:,14)));
% q3_basis =@(H)57.295779513082320876798154814105.*acos(0.0000014275725767664023876238374104053.*((1.1236023251261275046830387424953e-95.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.3265154900625065836792784538575e-74.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.9234485122593896084000733319511e+70.*sin(H(:,14)) - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (1.1236023251261275046830387424953e-95.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + 0.0000014275725767664023876238374104053.*((1.1236023251261275046830387424953e-95.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.1236023251261275046830387424953e-95.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.3265154900625065836792784538575e-74.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.9234485122593896084000733319511e+70.*sin(H(:,14)) - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + 0.0000014275725767664023876238374104053.*(H(:,12) + (1.1236023251261275046830387424953e-95.*H(:,9).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.1236023251261275046830387424953e-95.*H(:,10).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.3265154900625065836792784538575e-74.*H(:,11).*(2.9234485122593896084000733319511e+70.*sin(H(:,14)) - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - 127.30066779999999937444954412058).^2 - 1.0022498884889094413655047829436);
% q2_basis =@(H)- 57.295779513082320876798154814105.*asin((572.29811400000005505717126652598.*sin(H(:,16)))./(((1.1236023251261275046830387424953e-95.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.3265154900625065836792784538575e-74.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.9234485122593896084000733319511e+70.*sin(H(:,14)) - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (1.1236023251261275046830387424953e-95.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + ((1.1236023251261275046830387424953e-95.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.1236023251261275046830387424953e-95.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.3265154900625065836792784538575e-74.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.9234485122593896084000733319511e+70.*sin(H(:,14)) - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + (H(:,12) + (1.1236023251261275046830387424953e-95.*H(:,9).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.1236023251261275046830387424953e-95.*H(:,10).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.3265154900625065836792784538575e-74.*H(:,11).*(2.9234485122593896084000733319511e+70.*sin(H(:,14)) - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - 127.30066779999999937444954412058).^2).^(1./2)) + 57.295779513082320876798154814105.*atan2((1.3265154900625065836792784538575e-74.*H(:,11).*(6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2 + 2.9234485122593896084000733319511e+70.*sin(H(:,14))))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.1236023251261275046830387424953e-95.*H(:,9).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.1236023251261275046830387424953e-95.*H(:,10).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - 1.0.*H(:,12) + 127.30066779999999937444954412058, (1.3265154900625065836792784538575e-74.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.9537733644956615717920363283361e+75.*cos(H(:,14)).^2 - 1.6017413074534697971335956950627e+56.*cos(H(:,14)) + 6.9537733644956615717920363283361e+75.*sin(H(:,14)).^2 + 2.9234485122593896084000733319511e+70.*sin(H(:,14))))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.1236023251261275046830387424953e-95.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4513990522088707734068931783345e+91.*cos(H(:,14)).*cos(H(:,15)) + 6.9787445490577586684230890143381e+73.*cos(H(:,14)).*sin(H(:,15)) + 1.8910024949118025516928840241826e+77.*cos(H(:,15)).*sin(H(:,14)) - 1.2737387913044068535107593212711e+88.*sin(H(:,14)).*sin(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*cos(H(:,15)) - 3.9461470494040516249423426485247e+91.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.1236023251261275046830387424953e-95.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.9787445490577586684230890143381e+73.*cos(H(:,14)).*cos(H(:,15)) - 3.4513990522088707734068931783345e+91.*cos(H(:,14)).*sin(H(:,15)) - 1.2737387913044068535107593212711e+88.*cos(H(:,15)).*sin(H(:,14)) - 1.8910024949118025516928840241826e+77.*sin(H(:,14)).*sin(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0297229528958954033403750159113e+97.*cos(H(:,15)).*sin(H(:,14)).^2 + 3.9461470494040516249423426485247e+91.*cos(H(:,14)).^2.*sin(H(:,15)) + 3.9461470494040516249423426485247e+91.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.0.*H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2));
% q4_basis =@(H)57.295779513082320876798154814105.*atan2((4.276423536147512233562466438867e-50.*((2.9387358770557187790433053145637e-39.*H(:,10).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*sin(H(:,15)) + 1.2558120466153752393407502891562e+35.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.9387358770557187790433053145637e-39.*H(:,9).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*cos(H(:,15)) - 1.2558120466153752393407502891562e+35.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.99999993190104952444721184935989.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(6.0448731337232034337703741552592e+43.*cos(H(:,16)).*cos(H(:,17)).^2 - 2.3383406764951503471516980103027e+49.*cos(H(:,16)).*cos(H(:,17)) + 6.0448731337232034337703741552592e+43.*cos(H(:,16)).*sin(H(:,17)).^2 + 2.3384024718989810720308781762722e+49.*sin(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) + (1.9259299443872356538997145562073e-34.*(5.1922968585348281654547202617948e+33.*cos(H(:,17)).*sin(H(:,16)) + 5.1921596451658559721068462572831e+33.*cos(H(:,16)).*sin(H(:,17))).*((0.99999993190104952444721184935989.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (2.9387358770557187790433053145637e-39.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*cos(H(:,15)) - 1.2558120466153752393407502891562e+35.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (2.9387358770557187790433053145637e-39.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*sin(H(:,15)) + 1.2558120466153752393407502891562e+35.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (8.3523897190381098311766922634121e-53.*((2.9387358770557187790433053145637e-39.*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*sin(H(:,15)) + 1.2558120466153752393407502891562e+35.*cos(H(:,15)).*sin(H(:,14))).*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.9387358770557187790433053145637e-39.*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*cos(H(:,15)) - 1.2558120466153752393407502891562e+35.*sin(H(:,14)).*sin(H(:,15))).*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.99999993190104952444721184935989.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(8.7040185444248656669281832669895e+49.*cos(H(:,16)).*cos(H(:,17)).^2 + 4.2571121294891962977610237881749e+48.*cos(H(:,16)).*cos(H(:,17)) + 8.7040185444248656669281832669895e+49.*cos(H(:,16)).*sin(H(:,17)).^2 - 4.2572246323275717425070892794824e+48.*sin(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2), - (4.276423536147512233562466438867e-50.*((2.9387358770557187790433053145637e-39.*H(:,10).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*sin(H(:,15)) + 1.2558120466153752393407502891562e+35.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.9387358770557187790433053145637e-39.*H(:,9).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*cos(H(:,15)) - 1.2558120466153752393407502891562e+35.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.99999993190104952444721184935989.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(- 6.0448731337232034337703741552592e+43.*sin(H(:,16)).*cos(H(:,17)).^2 + 2.3383406764951503471516980103027e+49.*sin(H(:,16)).*cos(H(:,17)) - 6.0448731337232034337703741552592e+43.*sin(H(:,16)).*sin(H(:,17)).^2 + 2.3384024718989810720308781762722e+49.*cos(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (1.9259299443872356538997145562073e-34.*(5.1922968585348281654547202617948e+33.*cos(H(:,17)).*cos(H(:,16)) - 5.1921596451658559721068462572831e+33.*sin(H(:,17)).*sin(H(:,16))).*((0.99999993190104952444721184935989.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (2.9387358770557187790433053145637e-39.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*cos(H(:,15)) - 1.2558120466153752393407502891562e+35.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (2.9387358770557187790433053145637e-39.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*sin(H(:,15)) + 1.2558120466153752393407502891562e+35.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (8.3523897190381098311766922634121e-53.*((2.9387358770557187790433053145637e-39.*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*sin(H(:,15)) + 1.2558120466153752393407502891562e+35.*cos(H(:,15)).*sin(H(:,14))).*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.9387358770557187790433053145637e-39.*(3.4028236692093846240718123726794e+38.*cos(H(:,14)).*cos(H(:,15)) - 1.2558120466153752393407502891562e+35.*sin(H(:,14)).*sin(H(:,15))).*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.99999993190104952444721184935989.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(8.7040185444248656669281832669895e+49.*sin(H(:,16)).*cos(H(:,17)).^2 + 4.2571121294891962977610237881749e+48.*sin(H(:,16)).*cos(H(:,17)) + 8.7040185444248656669281832669895e+49.*sin(H(:,16)).*sin(H(:,17)).^2 + 4.2572246323275717425070892794824e+48.*cos(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2));


times = [];

a = 1
%%%%%Make sure DH parameters match UR10_Inverse_Homogenous.m%%%%
%H is wrapped such that H06(1:4,1) -> H(:,1:4), H06(1:4,2) -> H(:,5:8),
%H06(1:4,3) -> H(:,9:12), [q1, q5, q6, q3, q2, q4] -> H(:,13:18)
temp = tic; h_q1 = fitrgp(H_input,q1_deg,'BasisFunction',q1_basis,'Beta',1); times = [times; toc(temp)];
q1_pred = Hybrid_CrossVal(q1_basis,H_input,q1_deg,H_input,numFolds);%Cross-Validation Predictions
q1_cv_input = predict(h_q1,H_input); %create inputs for fair cv

a = 2
H_input = [H_input,q1_rad]; %Add q1 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q1_cv_input)]; %Add inputs for fair cv
temp = tic; h_q5 = fitrgp(H_input,q5_deg,'BasisFunction',q5_basis,'Beta',1); times = [times; toc(temp)];
q5_pred = Hybrid_CrossVal(q5_basis,H_input,q5_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q5_cv_input = predict(h_q5,H_input); %create inputs for fair cv

a = 3
H_input = [H_input,q5_rad]; %Add q5 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q5_cv_input)]; %Add inputs for fair cv
temp = tic; h_q6 = fitrgp(H_input,q6_deg,'BasisFunction',q6_basis,'Beta',1); times = [times; toc(temp)];
q6_pred = Hybrid_CrossVal(q6_basis,H_input,q6_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q6_cv_input = predict(h_q6,H_input); %create inputs for fair cv

a = 4
H_input = [H_input,q6_rad]; %Add q6 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q6_cv_input)]; %Add inputs for fair cv
temp = tic; h_q3 = fitrgp(H_input,q3_deg,'BasisFunction',q3_basis,'Beta',1); times = [times; toc(temp)];
q3_pred = Hybrid_CrossVal(q3_basis,H_input,q3_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q3_cv_input = predict(h_q3,H_input); %create inputs for fair cv

a = 5
H_input = [H_input,q3_rad]; %Add q3 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q3_cv_input)]; %Add inputs for fair cv
temp = tic; h_q2 = fitrgp(H_input,q2_deg,'BasisFunction',q2_basis,'Beta',1); times = [times; toc(temp)];
q2_pred = Hybrid_CrossVal(q2_basis,H_input,q2_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q2_cv_input = predict(h_q2,H_input); %create inputs for fair cv

a = 6
H_input = [H_input,q2_rad]; %Add q2 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q2_cv_input)]; %Add inputs for fair cv
temp = tic; h_q4 = fitrgp(H_input,q4_deg,'BasisFunction',q4_basis,'Beta',1); times = [times; toc(temp)];
q4_pred = Hybrid_CrossVal(q4_basis,H_input,q4_deg,H_input_cv,numFolds); %Cross-Validation Predictions

q_h = [q1_pred,q2_pred,q3_pred,q4_pred,q5_pred,q6_pred];
q_RMSE = sqrt(mean((q_deg-q_h).^2));
