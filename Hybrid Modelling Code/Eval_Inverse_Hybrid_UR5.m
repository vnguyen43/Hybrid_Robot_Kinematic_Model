clear all
close all
clc

r2s = csvread('Robot2Sensor_UR5.csv');%Sensor-Robot Transformation: Robot = r2s*TRIO
data = csvread('Data_UR5_1000.csv'); %Data of interest
data( ~any(data,2), : ) = []; %Remove 0's

q_deg = data(:,1:6); q = deg2rad(q_deg);
q1_rad = q(:,1); q2_rad = q(:,2); q3_rad = q(:,3); q4_rad = q(:,4); q5_rad = q(:,5); q6_rad = q(:,6);
q1_deg = q_deg(:,1); q2_deg = q_deg(:,2); q3_deg = q_deg(:,3); q4_deg = q_deg(:,4); q5_deg = q_deg(:,5); q6_deg = q_deg(:,6);
px = data(:,7); py = data(:,8); pz = data(:,9); rx = deg2rad(data(:,10)); ry = deg2rad(data(:,11)); rz = deg2rad(data(:,12));

for k = 1:1:length(q1_deg)

trio = eye(4);
trio(1:3,4) = [px(k);py(k);pz(k)];
trio(1:3,1:3) = (SpinCalc('EA321toDCM',rad2deg([rz(k),ry(k),rx(k)]),0))';
H06 = r2s*trio;

H60 = H06^-1;

H_input(k,:) = [H06(1,1),H06(1,2),H06(1,3),H06(1,4),H06(2,1),H06(2,2),H06(2,3),H06(2,4),H06(3,1),H06(3,2),H06(3,3),H06(3,4)];

%Dh parameters
d0 = 0;     d1 = 0.1273*1000;   d2 = 0;             d3 = 0;             d4 = 0.163941*1000;     d5 = 0.1157*1000;   d6 = 0.0922*1000;% d (unit: mm)
a0 = 0;     a1 = 0;             a2 = -0.612*1000;   a3 = -0.5723*1000;  a4 = 0;                 a5 = 0;             a6 = 0;% a (unit: mm)
p0 = 0;     p1 = +pi/2;         p2 = 0;             p3 = 0;             p4 = +pi/2;             p5 = -pi/2;         p6 = 0; %alpha

end

numFolds = 5;
H_input_cv = H_input;

%Uncalibrated
q1_basis = @(H)57.295779513082320876798154814105.*atan2(1.0.*H(:,8) - 82.3.*H(:,7), H(:,4) - 82.3.*H(:,3)) + 57.295779513082320876798154814105.*acos(109.15./((82.3.*H(:,3) - 1.0.*H(:,4)).^2 + (82.3.*H(:,7) - 1.0.*H(:,8)).^2).^(1./2)) + 90.0;
q5_basis = @(H)57.295779513082320876798154814105.*acos(0.012150668286755771567436208991495.*H(:,4).*sin(H(:,13)) - 0.012150668286755771567436208991495.*H(:,8).*cos(H(:,13)) - 1.3262454434993924665856622114216);
q6_basis = @(H)57.295779513082320876798154814105.*angle((((cos(H(:,13)).*(H(:,1).*H(:,11) - 1.0.*H(:,3).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,5).*H(:,11) - 1.0.*H(:,7).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9))).*1.0i)./sin(H(:,14)) + ((cos(H(:,13)).*(H(:,2).*H(:,11) - 1.0.*H(:,3).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,6).*H(:,11) - 1.0.*H(:,7).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)))./sin(H(:,14)));
q3_basis = @(H)57.295779513082320876798154814105.*acos(0.0000029992876691785700896037191167098.*((9.3633527093843966543116988277173e-98.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*cos(H(:,15)) - 6.3384835548012856743809412912109e+66.*sin(H(:,14)).*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (5.3181956838445838097171441191981e-126.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (9.3633527093843966543116988277173e-98.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*sin(H(:,15)) + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + 0.0000029992876691785700896037191167098.*((9.3633527093843966543116988277173e-98.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*sin(H(:,15)) + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (5.3181956838445838097171441191981e-126.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.0.*H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (9.3633527093843966543116988277173e-98.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*cos(H(:,15)) - 6.3384835548012856743809412912109e+66.*sin(H(:,14)).*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)).^2 + 0.0000029992876691785700896037191167098.*(H(:,12) + (9.3633527093843966543116988277173e-98.*H(:,9).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*sin(H(:,15)) + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (5.3181956838445838097171441191981e-126.*H(:,11).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (9.3633527093843966543116988277173e-98.*H(:,10).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*cos(H(:,15)) - 6.3384835548012856743809412912109e+66.*sin(H(:,14)).*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - 89.16).^2 - 1.0032169234806733400817305889851);
q2_basis = @(H)57.295779513082320876798154814105.*atan2((5.3181956838445838097171441191981e-126.*H(:,11).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (9.3633527093843966543116988277173e-98.*H(:,9).*(1.0108558647495706964934440224447e+99.*sin(H(:,15)).*cos(H(:,14)).^2 + 3.8812017984177657313166530969348e+50.*sin(H(:,15)).*cos(H(:,14)) + 1.0108558647495706964934440224447e+99.*sin(H(:,15)).*sin(H(:,14)).^2 + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - 1.0.*H(:,12) - (9.3633527093843966543116988277173e-98.*H(:,10).*(1.0108558647495706964934440224447e+99.*cos(H(:,15)).*cos(H(:,14)).^2 + 3.8812017984177657313166530969348e+50.*cos(H(:,15)).*cos(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2 - 6.3384835548012856743809412912109e+66.*sin(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + 89.16, (5.3181956838445838097171441191981e-126.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (9.3633527093843966543116988277173e-98.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(1.0108558647495706964934440224447e+99.*cos(H(:,15)).*cos(H(:,14)).^2 + 3.8812017984177657313166530969348e+50.*cos(H(:,15)).*cos(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2 - 6.3384835548012856743809412912109e+66.*sin(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (9.3633527093843966543116988277173e-98.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(1.0108558647495706964934440224447e+99.*sin(H(:,15)).*cos(H(:,14)).^2 + 3.8812017984177657313166530969348e+50.*sin(H(:,15)).*cos(H(:,14)) + 1.0108558647495706964934440224447e+99.*sin(H(:,15)).*sin(H(:,14)).^2 + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.0.*H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)) - 57.295779513082320876798154814105.*asin((392.25.*sin(H(:,16)))./(((9.3633527093843966543116988277173e-98.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*cos(H(:,15)) - 6.3384835548012856743809412912109e+66.*sin(H(:,14)).*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (5.3181956838445838097171441191981e-126.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (9.3633527093843966543116988277173e-98.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*sin(H(:,15)) + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + ((9.3633527093843966543116988277173e-98.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*sin(H(:,15)) + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (5.3181956838445838097171441191981e-126.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.0.*H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (9.3633527093843966543116988277173e-98.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*cos(H(:,15)) - 6.3384835548012856743809412912109e+66.*sin(H(:,14)).*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)).^2 + (H(:,12) + (9.3633527093843966543116988277173e-98.*H(:,9).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*sin(H(:,15)) + 6.3384835548012856743809412912109e+66.*cos(H(:,15)).*sin(H(:,14)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (5.3181956838445838097171441191981e-126.*H(:,11).*(1.5475173328053322958218152003999e+127.*cos(H(:,14)).^2 - 1.1159697892750848575013052859382e+95.*cos(H(:,14)) + 1.5475173328053322958218152003999e+127.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (9.3633527093843966543116988277173e-98.*H(:,10).*(3.8812017984177657313166530969348e+50.*cos(H(:,14)).*cos(H(:,15)) - 6.3384835548012856743809412912109e+66.*sin(H(:,14)).*sin(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.0108558647495706964934440224447e+99.*cos(H(:,15)).*sin(H(:,14)).^2))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - 89.16).^2).^(1./2));
q4_basis = @(H)57.295779513082320876798154814105.*atan2((1.0.*(cos(H(:,17)).*sin(H(:,16)) + cos(H(:,16)).*sin(H(:,17))).*((1.0.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (0.00000000000000006123233995736766035868820147292.*(cos(H(:,17)).*cos(H(:,16)) - 1.0.*sin(H(:,17)).*sin(H(:,16))).*((1.0.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))).*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))).*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (1.0.*(cos(H(:,17)).*cos(H(:,16)) - 1.0.*sin(H(:,17)).*sin(H(:,16))).*((1.0.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*H(:,9).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*H(:,10).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2), - (1.0.*(cos(H(:,17)).*cos(H(:,16)) - 1.0.*sin(H(:,17)).*sin(H(:,16))).*((1.0.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (0.00000000000000006123233995736766035868820147292.*(cos(H(:,17)).*sin(H(:,16)) + cos(H(:,16)).*sin(H(:,17))).*((1.0.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))).*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))).*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (1.0.*(cos(H(:,17)).*sin(H(:,16)) + cos(H(:,16)).*sin(H(:,17))).*((1.0.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - (1.5192908393215677995957187631299e-64.*H(:,9).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*cos(H(:,15)) - 4.0303237782115947365697332263082e+47.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (1.5192908393215677995957187631299e-64.*H(:,10).*(6.5820182292848241686198767302294e+63.*cos(H(:,14)).*sin(H(:,15)) + 4.0303237782115947365697332263082e+47.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2));
 
%Calibrated
% q1_basis = @(H)57.295779513082320876798154814105.*atan2(1.0.*H(:,8) - 82.300040114899999821318488102406.*H(:,7), H(:,4) - 82.300040114899999821318488102406.*H(:,3)) + 57.295779513082320876798154814105.*acos(109.83488499999998566636350005865./((82.300040114899999821318488102406.*H(:,3) - 1.0.*H(:,4)).^2 + (82.300040114899999821318488102406.*H(:,7) - 1.0.*H(:,8)).^2).^(1./2)) + 90.0;
% q5_basis =@(H)57.295779513082320876798154814105.*acos(0.012150662364245374565058597593334.*H(:,4).*sin(H(:,13)) - 0.012150662364245374565058597593334.*H(:,8).*cos(H(:,13)) - 1.334566603450718652971958522314);
% q6_basis =@(H)57.295779513082320876798154814105.*angle((((cos(H(:,13)).*(H(:,1).*H(:,11) - 1.0.*H(:,3).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,5).*H(:,11) - 1.0.*H(:,7).*H(:,9)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9))).*1.0i)./sin(H(:,14)) + ((cos(H(:,13)).*(H(:,2).*H(:,11) - 1.0.*H(:,3).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)) + (sin(H(:,13)).*(H(:,6).*H(:,11) - 1.0.*H(:,7).*H(:,10)))./(H(:,1).*H(:,6).*H(:,11) - 1.0.*H(:,1).*H(:,7).*H(:,10) - 1.0.*H(:,2).*H(:,5).*H(:,11) + H(:,2).*H(:,7).*H(:,9) + H(:,3).*H(:,5).*H(:,10) - 1.0.*H(:,3).*H(:,6).*H(:,9)))./sin(H(:,14)));
% q3_basis =@(H)57.295779513082320876798154814105.*acos(0.0000030016924151033479494759408722442.*((3.5373746401666847066328328517915e-74.*H(:,11).*(3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 9.5070497118902580675378660448871e+69.*sin(H(:,14)) + 2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - 1.0.*H(:,12) + (2.3970182936024056709480896608569e-94.*H(:,9).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*H(:,10).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + 89.16010779999999158462742343545).^2 + 0.0000030016924151033479494759408722442.*((2.3970182936024056709480896608569e-94.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (3.5373746401666847066328328517915e-74.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 9.5070497118902580675378660448871e+69.*sin(H(:,14)) + 2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + 0.0000030016924151033479494759408722442.*((3.5373746401666847066328328517915e-74.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 9.5070497118902580675378660448871e+69.*sin(H(:,14)) + 2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (2.3970182936024056709480896608569e-94.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.0.*H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 - 1.0031529502264539625150267346929);
% q2_basis =@(H)57.295779513082320876798154814105.*atan2((3.5373746401666847066328328517915e-74.*H(:,11).*(2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2 + 9.5070497118902580675378660448871e+69.*sin(H(:,14))))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - 1.0.*H(:,12) + (2.3970182936024056709480896608569e-94.*H(:,9).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*H(:,10).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + 89.16010779999999158462742343545, (3.5373746401666847066328328517915e-74.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2 + 9.5070497118902580675378660448871e+69.*sin(H(:,14))))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (2.3970182936024056709480896608569e-94.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.0.*H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)) - 57.295779513082320876798154814105.*asin((392.24989722999998775776475667953.*sin(H(:,16)))./(((3.5373746401666847066328328517915e-74.*H(:,11).*(3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 9.5070497118902580675378660448871e+69.*sin(H(:,14)) + 2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) - 1.0.*H(:,12) + (2.3970182936024056709480896608569e-94.*H(:,9).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*H(:,10).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + 89.16010779999999158462742343545).^2 + ((2.3970182936024056709480896608569e-94.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (3.5373746401666847066328328517915e-74.*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 9.5070497118902580675378660448871e+69.*sin(H(:,14)) + 2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (H(:,4).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,8).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2 + ((3.5373746401666847066328328517915e-74.*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(3.0373156874353838463618677503695e+55.*cos(H(:,14)) + 9.5070497118902580675378660448871e+69.*sin(H(:,14)) + 2.3277967028284106785184950394417e+75.*cos(H(:,14)).^2 + 2.3277967028284106785184950394417e+75.*sin(H(:,14)).^2))./(cos(H(:,14)).^2 + sin(H(:,14)).^2) + (2.3970182936024056709480896608569e-94.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(2.029229988997400266215379786181e+72.*cos(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*cos(H(:,15)) + 4.4822872719132347655729882797303e+75.*cos(H(:,15)).*sin(H(:,14)) + 6.3516579662966711148875441115663e+86.*sin(H(:,14)).*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*cos(H(:,15)) + 1.8978161377163694128371121737976e+90.*cos(H(:,15)).*sin(H(:,14)).^2 - 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*sin(H(:,15)) - 3.9486543726854922100554923974352e+95.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (2.3970182936024056709480896608569e-94.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(4.4822872719132347655729882797303e+75.*sin(H(:,14)).*sin(H(:,15)) - 1.402993047226957028084271690651e+90.*cos(H(:,14)).*sin(H(:,15)) - 6.3516579662966711148875441115663e+86.*cos(H(:,15)).*sin(H(:,14)) - 2.029229988997400266215379786181e+72.*cos(H(:,14)).*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,14)).^2.*cos(H(:,15)) + 3.9486543726854922100554923974352e+95.*cos(H(:,15)).*sin(H(:,14)).^2 + 1.8978161377163694128371121737976e+90.*cos(H(:,14)).^2.*sin(H(:,15)) + 1.8978161377163694128371121737976e+90.*sin(H(:,14)).^2.*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.0.*H(:,8).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,4).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).^2).^(1./2));
% q4_basis =@(H)57.295779513082320876798154814105.*atan2((3.0092655381050562396722089238106e-36.*(3.3230699894622894401216928892128e+35.*cos(H(:,17)).*sin(H(:,16)) + 3.3230680012411181102938737612528e+35.*cos(H(:,16)).*sin(H(:,17))).*((1.880790961315660182810443696194e-37.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*sin(H(:,15)) + 2.4070829446059420524478521713623e+33.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.880790961315660182810443696194e-37.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*cos(H(:,15)) - 2.4070829446059420524478521713623e+33.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.9999998975213971535355987428179.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (2.6727647100921958124221304730997e-51.*((1.880790961315660182810443696194e-37.*H(:,10).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*sin(H(:,15)) + 2.4070829446059420524478521713623e+33.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.880790961315660182810443696194e-37.*H(:,9).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*cos(H(:,15)) - 2.4070829446059420524478521713623e+33.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.9999998975213971535355987428179.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(1.1512947750714431297089387330262e+44.*cos(H(:,16)).*cos(H(:,17)).^2 + 3.7414418049995096631656504040917e+50.*cos(H(:,16)).*cos(H(:,17)) + 1.1512947750714431297089387330262e+44.*cos(H(:,16)).*sin(H(:,17)).^2 - 3.7414440435374526785419130041385e+50.*sin(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) + (1.6313261169996312331678042438353e-55.*((1.880790961315660182810443696194e-37.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*sin(H(:,15)) + 2.4070829446059420524478521713623e+33.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.880790961315660182810443696194e-37.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*cos(H(:,15)) - 2.4070829446059420524478521713623e+33.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.9999998975213971535355987428179.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(6.7055858859704906082721885352453e+51.*cos(H(:,16)).*cos(H(:,17)).^2 - 1.7243629281391469627299953080235e+51.*cos(H(:,16)).*cos(H(:,17)) + 6.7055858859704906082721885352453e+51.*cos(H(:,16)).*sin(H(:,17)).^2 + 1.7243639598408393452159493470682e+51.*sin(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2), - (1.6313261169996312331678042438353e-55.*((1.880790961315660182810443696194e-37.*((H(:,6).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,2).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*sin(H(:,15)) + 2.4070829446059420524478521713623e+33.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.880790961315660182810443696194e-37.*((H(:,5).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,1).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*cos(H(:,15)) - 2.4070829446059420524478521713623e+33.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.9999998975213971535355987428179.*sin(H(:,14)).*((H(:,7).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) - (1.0.*H(:,3).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(- 6.7055858859704906082721885352453e+51.*sin(H(:,16)).*cos(H(:,17)).^2 + 1.7243629281391469627299953080235e+51.*sin(H(:,16)).*cos(H(:,17)) - 6.7055858859704906082721885352453e+51.*sin(H(:,16)).*sin(H(:,17)).^2 + 1.7243639598408393452159493470682e+51.*cos(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (3.0092655381050562396722089238106e-36.*(3.3230699894622894401216928892128e+35.*cos(H(:,17)).*cos(H(:,16)) - 3.3230680012411181102938737612528e+35.*sin(H(:,17)).*sin(H(:,16))).*((1.880790961315660182810443696194e-37.*((H(:,2).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,6).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*sin(H(:,15)) + 2.4070829446059420524478521713623e+33.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.880790961315660182810443696194e-37.*((H(:,1).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,5).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*cos(H(:,15)) - 2.4070829446059420524478521713623e+33.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.9999998975213971535355987428179.*sin(H(:,14)).*((H(:,3).*cos(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2) + (H(:,7).*sin(H(:,13)))./(cos(H(:,13)).^2 + sin(H(:,13)).^2)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2) - (2.6727647100921958124221304730997e-51.*((1.880790961315660182810443696194e-37.*H(:,10).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*sin(H(:,15)) + 2.4070829446059420524478521713623e+33.*cos(H(:,15)).*sin(H(:,14))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) - (1.880790961315660182810443696194e-37.*H(:,9).*(5.3169119831396630108618940999999e+36.*cos(H(:,14)).*cos(H(:,15)) - 2.4070829446059420524478521713623e+33.*sin(H(:,14)).*sin(H(:,15))))./(cos(H(:,14)).^2.*cos(H(:,15)).^2 + cos(H(:,14)).^2.*sin(H(:,15)).^2 + cos(H(:,15)).^2.*sin(H(:,14)).^2 + sin(H(:,14)).^2.*sin(H(:,15)).^2) + (0.9999998975213971535355987428179.*H(:,11).*sin(H(:,14)))./(cos(H(:,14)).^2 + sin(H(:,14)).^2)).*(1.1512947750714431297089387330262e+44.*sin(H(:,16)).*cos(H(:,17)).^2 + 3.7414418049995096631656504040917e+50.*sin(H(:,16)).*cos(H(:,17)) + 1.1512947750714431297089387330262e+44.*sin(H(:,16)).*sin(H(:,17)).^2 + 3.7414440435374526785419130041385e+50.*cos(H(:,16)).*sin(H(:,17))))./(cos(H(:,17)).^2.*cos(H(:,16)).^2 + cos(H(:,17)).^2.*sin(H(:,16)).^2 + cos(H(:,16)).^2.*sin(H(:,17)).^2 + sin(H(:,17)).^2.*sin(H(:,16)).^2));
 


times = [];

a = 1
%%%%%Make sure DH parameters match UR10_Inverse_Homogenous.m%%%%
%H is wrapped such that H06(1:4,1) -> H(:,1:4), H06(1:4,2) -> H(:,5:8),
%H06(1:4,3) -> H(:,9:12), [q1, q5, q6, q3, q2, q4] -> H(:,13:18)
temp = tic; h_q1 = fitrgp(H_input,q1_deg,'BasisFunction',q1_basis,'Beta',1); times = [times; toc(temp)];
q1_pred = Hybrid_CrossVal(q1_basis,H_input,q1_deg,H_input,numFolds);%Cross-Validation Predictions
q1_cv_input = predict(h_q1,H_input); %create inputs for fair cv

a = 2
H_input = [H_input,q1_rad]; %Add q1 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q1_cv_input)]; %Add inputs for fair cv
temp = tic; h_q5 = fitrgp(H_input,q5_deg,'BasisFunction',q5_basis,'Beta',1); times = [times; toc(temp)];
q5_pred = Hybrid_CrossVal(q5_basis,H_input,q5_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q5_cv_input = predict(h_q5,H_input); %create inputs for fair cv

a = 3
H_input = [H_input,q5_rad]; %Add q5 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q5_cv_input)]; %Add inputs for fair cv
temp = tic; h_q6 = fitrgp(H_input,q6_deg,'BasisFunction',q6_basis,'Beta',1); times = [times; toc(temp)];
q6_pred = Hybrid_CrossVal(q6_basis,H_input,q6_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q6_cv_input = predict(h_q6,H_input); %create inputs for fair cv

a = 4
H_input = [H_input,q6_rad]; %Add q6 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q6_cv_input)]; %Add inputs for fair cv
temp = tic; h_q3 = fitrgp(H_input,q3_deg,'BasisFunction',q3_basis,'Beta',1); times = [times; toc(temp)];
q3_pred = Hybrid_CrossVal(q3_basis,H_input,q3_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q3_cv_input = predict(h_q3,H_input); %create inputs for fair cv

a = 5
H_input = [H_input,q3_rad]; %Add q3 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q3_cv_input)]; %Add inputs for fair cv
temp = tic; h_q2 = fitrgp(H_input,q2_deg,'BasisFunction',q2_basis,'Beta',1); times = [times; toc(temp)];
q2_pred = Hybrid_CrossVal(q2_basis,H_input,q2_deg,H_input_cv,numFolds); %Cross-Validation Predictions
q2_cv_input = predict(h_q2,H_input); %create inputs for fair cv

a = 6
H_input = [H_input,q2_rad]; %Add q2 (radians) to the input
H_input_cv = [H_input_cv, deg2rad(q2_cv_input)]; %Add inputs for fair cv
temp = tic; h_q4 = fitrgp(H_input,q4_deg,'BasisFunction',q4_basis,'Beta',1); times = [times; toc(temp)];
q4_pred = Hybrid_CrossVal(q4_basis,H_input,q4_deg,H_input_cv,numFolds); %Cross-Validation Predictions

q_h = [q1_pred,q2_pred,q3_pred,q4_pred,q5_pred,q6_pred];
q_RMSE = sqrt(mean((q_deg-q_h).^2));
